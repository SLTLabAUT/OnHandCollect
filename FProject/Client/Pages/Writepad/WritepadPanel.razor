@namespace FProject.Client.Pages

<Stack ClassName=@("panel" + (PanelCollapsed ? " panel-collapsed" : "")) Horizontal=true VerticalFill=true Reversed=true HorizontalAlign=Alignment.Center VerticalAlign=Alignment.Center>
    <StackItem>
        <Stack VerticalFill=true HorizontalAlign=Alignment.Center VerticalAlign=Alignment.Center Tokens=@(new StackTokens { ChildrenGap = new double[] { 10 } })>
            <StackItem VerticalFill=false Align=Alignment.Center Style="width: 100%;">
                <Stack Reversed=true Horizontal=true VerticalAlign=Alignment.Center>
                    <StackItem>
                        <TooltipHost>
                            <TooltipContent>اطلاعات تخته</TooltipContent>
                            <ChildContent>
                                <MyBFUIconButton Variant=TextType.Large IconName="Info" />
                            </ChildContent>
                        </TooltipHost>
                    </StackItem>
                    <StackItem Grow=1 Style="text-align:center;margin:0 5px;"><MyBFUText Variant=TextType.XLarge Style="white-space:nowrap;">تخته‌ی شماره‌ی @Parent.WritepadInstance.SpecifiedNumber</MyBFUText></StackItem>
                    <StackItem Tokens=@(new StackItemTokens { Padding = "0 4px" })>
                        @{
                            string pointerTypeTooltip = string.Empty;
                            string pointerTypeIconName = string.Empty;
                            switch (Parent.WritepadInstance.PointerType)
                            {
                                case FProject.Shared.PointerType.Mouse:
                                    pointerTypeTooltip = "موس";
                                    pointerTypeIconName = "TouchPointer";
                                    break;
                                case FProject.Shared.PointerType.Touchpad:
                                    pointerTypeTooltip = "تاچ‌پد";
                                    pointerTypeIconName = "TouchPointer";
                                    break;
                                case FProject.Shared.PointerType.Pen:
                                    pointerTypeTooltip = "قلم";
                                    pointerTypeIconName = "PenWorkspace";
                                    break;
                                case FProject.Shared.PointerType.Touch:
                                    pointerTypeTooltip = "لمس";
                                    pointerTypeIconName = "Touch";
                                    break;
                            }

                            string textTypeTooltip = string.Empty;
                            string textTypeIconName = string.Empty;
                            switch (Parent.WritepadInstance.Type)
                            {
                                case FProject.Shared.WritepadType.Text:
                                    textTypeTooltip = "متن";
                                    textTypeIconName = "TextDocument";
                                    break;
                                case FProject.Shared.WritepadType.WordGroup:
                                    textTypeTooltip = "گروه کلمات";
                                    textTypeIconName = "TextBox";
                                    break;
                                case FProject.Shared.WritepadType.Sign:
                                    textTypeTooltip = "امضا";
                                    textTypeIconName = "InsertSignatureLine";
                                    break;
                            }
                        }
                        <MyBFUText Variant=@TextType.Large>
                            <TooltipHost>
                                <TooltipContent>@pointerTypeTooltip</TooltipContent>
                                <ChildContent>
                                    <Icon IconName=@pointerTypeIconName />
                                </ChildContent>
                            </TooltipHost>
                            <TooltipHost>
                                <TooltipContent>@textTypeTooltip</TooltipContent>
                                <ChildContent>
                                    <Icon IconName=@textTypeIconName />
                                </ChildContent>
                            </TooltipHost>
                        </MyBFUText>
                    </StackItem>
                </Stack>
            </StackItem>
            <Hr />
            <StackItem Grow=1 Align=Alignment.Center Style="overflow:auto;">
                <MyBFUText Block="true" Variant=@TextType.Medium
                           Style=@($"text-align:justify;{(Parent.WritepadInstance.Type != FProject.Shared.WritepadType.Text ? "text-align-last:center;" : "")}")>
                    @{ 
                        var textHeader = string.Empty;
                        switch (Parent.WritepadInstance.Type)
                        {
                            case FProject.Shared.WritepadType.Text:
                                textHeader = "لطفا متن زیر را عینا در تخته بنویسید:";
                                break;
                            case FProject.Shared.WritepadType.WordGroup:
                                textHeader = "لطفا کلمات زیر را با رعایت فاصله‌ی مناسب عینا در تخته بنویسید:";
                                break;
                            case FProject.Shared.WritepadType.Sign:
                                textHeader = "لطفا امضای خود را بکشید. بهتر است که امضای اصلیتان نباشد.";
                                break;
                        }
                    }
                    @textHeader
                    <br />
                    <br />
                    @((MarkupString) (Parent.WritepadInstance.Text?.Content ?? string.Empty))
                </MyBFUText>
            </StackItem>
            <Hr />
            <StackItem VerticalFill=false Align=Alignment.Center Style="width: 100%;">
                <Stack Horizontal=true VerticalFill=true Reversed=true HorizontalAlign=Alignment.Center VerticalAlign=Alignment.Center>
                    <StackItem Grow=1>
                        <Stack>
                            <StackItem>
                                <Stack Horizontal=true VerticalFill=true Reversed=true HorizontalAlign=Alignment.SpaceAround VerticalAlign=Alignment.Center>
                                    <StackItem VerticalFill=false>
                                        <MyBFUIconButton IconName="Undo" Disabled=UndoDisabled OnClick=@(args => UndoRedoHander()) />
                                    </StackItem>
                                    <StackItem VerticalFill=false>
                                        <MyBFUIconButton IconName="Redo" Disabled=RedoDisabled OnClick=@(args => UndoRedoHander(true)) />
                                    </StackItem>
                                </Stack>
                            </StackItem>
                            <StackItem>
                                <Stack Horizontal=true VerticalFill=true Reversed=true HorizontalAlign=Alignment.SpaceAround VerticalAlign=Alignment.Center>
                                    <StackItem VerticalFill=false>
                                        <MyBFUIconButton IconName="Edit" Disabled=!MoveDisabled OnClick=@(args => ChangeDefaultModeHandler(FProject.Shared.DrawingMode.Non)) />
                                    </StackItem>
                                    <StackItem VerticalFill=false>
                                        <MyBFUIconButton IconName="Move" Disabled=MoveDisabled OnClick=@(args => ChangeDefaultModeHandler(FProject.Shared.DrawingMode.Move)) />
                                    </StackItem>
                                </Stack>
                            </StackItem>
                        </Stack>
                    </StackItem>
                    <StackItem Style="margin-left:5px;">
                        <Stack VerticalFill=true HorizontalAlign=Alignment.Center VerticalAlign=Alignment.Center>
                            <StackItem>
                                <Toggle Disabled=@(Parent.AdminReview || Parent.WritepadInstance.Status == FProject.Shared.WritepadStatus.Accepted) InlineLabel="true" Checked=Parent.AutoSaveChecked Label="‌ذخیره‌ی خودکار" OffText=" " OnText=" " CheckedChanged=AutoSaveChangedHandler />
                            </StackItem>
                            <StackItem Style="width: 100%;" ClassName=@(Parent.IsSaving ? "has-ms-Spinner--small" : "")>
                                @if (Parent.IsSaving)
                                {
                                    <Spinner Size=@SpinnerSize.Small ClassName="save-spinner" />
                                }
                                <PrimaryButton Text="ذخیره" IconName="Save" Style="width: 100%;" Disabled=@(Parent.AdminReview || Parent.IsSaving || Parent.WritepadInstance.Status == FProject.Shared.WritepadStatus.Accepted) OnClick=@(args => Parent.SaveTimerElapsedHandler()) />
                            </StackItem>
                            <StackItem>
                                <TooltipHost Style="white-space:nowrap;">
                                    <TooltipContent>آخرین بروزرسانی</TooltipContent>
                                    <ChildContent>
                                        <MyBFUText Variant=@TextType.Tiny>آ.ب: @Parent.WritepadInstance.GetLocalTimeString()</MyBFUText>
                                    </ChildContent>
                                </TooltipHost>
                            </StackItem>
                        </Stack>
                    </StackItem>
                </Stack>
            </StackItem>
        </Stack>
    </StackItem>
    <StackItem Style="margin-left:8px;">
        <hr style="height:100%;" />
    </StackItem>
    <StackItem ClassName="panel-collapse-section">
        <Stack VerticalFill=true HorizontalAlign=Alignment.Center VerticalAlign=Alignment.Center>
            <StackItem VerticalFill=false>
                <TooltipHost>
                    <TooltipContent>بازگشت به لیست تخته‌ها</TooltipContent>
                    <ChildContent>
                        <MyBFUIconButton Variant=TextType.Large IconName="AppIconDefaultList" OnClick=LeaveHandler />
                    </ChildContent>
                </TooltipHost>
            </StackItem>
            <StackItem Grow=1 Align=Alignment.Center>
                <Stack VerticalFill=true VerticalAlign=Alignment.Center>
                    <TooltipHost>
                        <TooltipContent>جمع/باز کردن پنل</TooltipContent>
                        <ChildContent>
                            <MyBFUIconButton ClassName="panel-open-close" Variant=TextType.XxLargePlus IconName="NavigationFlipper" OnClick=OpenCollapseHandler />
                        </ChildContent>
                    </TooltipHost>
                </Stack>
            </StackItem>
            <StackItem VerticalFill=false>
                <TooltipHost>
                    <TooltipContent>راهنما</TooltipContent>
                    <ChildContent>
                        <MyBFUIconButton Variant=TextType.Large IconName="HelpMirrored" OnClick=@(args => HelpDialogOpen = true) />
                    </ChildContent>
                </TooltipHost>
            </StackItem>
        </Stack>
    </StackItem>
</Stack>

<MyBFUDialog Title="عدم امکان ذخیره‌ی امضا"
        IsOpen=@NotAllowedDialogOpen
        OnDismiss=@(args => NotAllowedDialogOpen=false)
        CloseButtonAriaLabel="بستن"
        Style="text-align: right;">
    <ChildContent>
        <p>نوشتن تخته‌ی امضا با نوع ورودی یکسان تنها ۷ عدد در هر ۱۲ ساعت مجاز است.</p>
    </ChildContent>
    <FooterTemplate></FooterTemplate>
</MyBFUDialog>

<MyBFUDialog Title="تایید ترک تخته بدون ذخیره‌ی آخرین تغییرات"
        IsOpen=@LeaveConfirmDialogOpen
        OnDismiss=@(args => LeaveConfirmDialogOpen=false)
        CloseButtonAriaLabel="بستن"
        Style="text-align: right;">
    <ChildContent>
        <p>آیا از ترک تخته بدون ذخیره‌ی آخرین تغییرات اطمینان دارید؟</p>
    </ChildContent>
    <FooterTemplate>
        <PrimaryButton Text="لغو ترک تخته" OnClick=@(args => LeaveConfirmDialogOpen=false) />
        <DefaultButton Text="ترک تخته" OnClick=@(args => Leave()) />
    </FooterTemplate>
</MyBFUDialog>

<MyBFUDialog Title="ویدیوی راهنمای سامانه"
        IsOpen=@HelpDialogOpen
        OnDismiss=HelpDismissHandler
        CloseButtonAriaLabel="بستن"
        Style="text-align:right;"
        ContainerClass="help-dialog">
    <ChildContent>
        <HelpVideo id="video" />
    </ChildContent>
    <FooterTemplate></FooterTemplate>
</MyBFUDialog>
